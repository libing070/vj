(function(e){function t(t){for(var o,r,l=t[0],s=t[1],c=t[2],u=0,f=[];u<l.length;u++)r=l[u],n[r]&&f.push(n[r][0]),n[r]=0;for(o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o]);d&&d(t);while(f.length)f.shift()();return a.push.apply(a,c||[]),i()}function i(){for(var e,t=0;t<a.length;t++){for(var i=a[t],o=!0,l=1;l<i.length;l++){var s=i[l];0!==n[s]&&(o=!1)}o&&(a.splice(t--,1),e=r(r.s=i[0]))}return e}var o={},n={fileModelConfig:0},a=[];function r(t){if(o[t])return o[t].exports;var i=o[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=o,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(i,o,function(t){return e[t]}.bind(null,o));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/cmca/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],s=l.push.bind(l);l.push=t,l=l.slice();for(var c=0;c<l.length;c++)t(l[c]);var d=s;a.push([0,"chunk-vendors"]),i()})({0:function(e,t,i){e.exports=i("fe99")},"0bb8":function(e,t,i){"use strict";var o=i("3dab"),n=i.n(o);n.a},"0cb6":function(e,t,i){"use strict";var o=i("b999"),n=i.n(o);n.a},"233e":function(e,t,i){"use strict";var o=i("a355"),n=i.n(o);n.a},"3cc9":function(e,t,i){},"3dab":function(e,t,i){},4199:function(e,t,i){"use strict";var o=i("9290"),n=i.n(o);n.a},5414:function(e,t,i){},"6f88":function(e,t,i){"use strict";var o=i("6fe6"),n=i.n(o);n.a},"6fe6":function(e,t,i){},7042:function(e,t,i){},"7dd0":function(e,t,i){},"8f07":function(e,t,i){"use strict";var o=i("c336"),n=i.n(o);n.a},"927c":function(e,t,i){},9290:function(e,t,i){},9835:function(e,t,i){"use strict";var o=i("f8e5"),n=i.n(o);n.a},a355:function(e,t,i){},a7cf:function(e,t,i){"use strict";var o=i("ed08"),n=i.n(o);n.a},b51b:function(e,t,i){},b999:function(e,t,i){},c336:function(e,t,i){},d233:function(e,t,i){"use strict";var o=i("b51b"),n=i.n(o);n.a},eb51:function(e,t,i){"use strict";var o=i("3cc9"),n=i.n(o);n.a},ed08:function(e,t,i){},f14d:function(e,t,i){"use strict";var o=i("927c"),n=i.n(o);n.a},f4a8:function(e,t,i){"use strict";var o=i("7042"),n=i.n(o);n.a},f8e5:function(e,t,i){},fe99:function(e,t,i){"use strict";i.r(t);i("3a0f"),i("a3a3"),i("4d0b");var o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("the-layout",[i("div",{attrs:{slot:"main-container"},slot:"main-container"},[i("el-breadcrumb",{attrs:{separator:"\\"}},[i("el-breadcrumb-item",{staticClass:"breadcrumb-active"},[e._v("报告模板配置")]),i("el-breadcrumb-item",{class:{"breadcrumb-active":e.editContentVisible},nativeOn:{click:function(t){return e.hideEditContent(t)}}},[e._v("\n        "+e._s(e.activeTabName)+"\n      ")]),e.editContentVisible?i("el-breadcrumb-item",[e._v("模板编辑")]):e._e()],1),i("el-card",{staticClass:"main-body"},[i("main-tab",{directives:[{name:"show",rawName:"v-show",value:!e.editContentVisible,expression:"!editContentVisible"}]}),e.editContentVisible?i("main-edit"):e._e()],1)],1)])},n=[],a=i("efa4"),r=i("f2de"),l=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"app"}},[i("the-header"),i("div",{staticClass:"main-wrap clearfix"},[i("the-sidebar",{staticClass:"float-l"}),i("div",{staticClass:"main-container"},[e._t("main-container")],2)],1)],1)},s=[],c=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},d=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-header"},[i("h1",[e._v("数据审计平台")])])}],u={name:"TheHeader"},f=u,p=(i("eb51"),i("048f")),m=Object(p["a"])(f,c,d,!1,null,"0a3ba4f3",null);m.options.__file="TheHeader.vue";var h=m.exports,g=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-sidebar"},[i("ul",{class:e.isCollapse?"collapse-sidebar sidebar-nav-list":"sidebar-nav-list"},e._l(e.navList,function(t,o){return i("li",{key:o,staticClass:"sidebar-nav-item"},[i("div",{staticClass:"sidebar-nav-sub-menu"},[i("a",{class:-1!==JSON.stringify(t).indexOf(e.ActivePage)?"active nav-item-icon":"nav-item-icon",attrs:{href:"javascript:;"},on:{mouseover:function(i){e.HoverSate(t.index)},mouseout:function(t){e.HoverSate(-1)},click:function(i){e.navRoute(t)}}},[i("span",{class:t.iconfont}),e.isCollapse?e._e():i("span",{staticClass:"nav-content"},[e._v(e._s(t.name))]),e.isCollapse?e._e():i("i",{staticClass:"iconfont icon-point float-r"})]),i("transition",{attrs:{name:"fade"}},[e.isCollapse?i("a",{directives:[{name:"show",rawName:"v-show",value:e.hoverActiveIndex===t.index,expression:"hoverActiveIndex === lv1item.index"}],staticClass:"nav-item-tip",attrs:{href:"javascript:;"}},[i("i",{staticClass:"iconfont icon-point"}),e._v(e._s(t.name)+"\n          ")]):e._e()])],1),i("el-collapse-transition",[t.child?i("ul",{directives:[{name:"show",rawName:"v-show",value:-1!==JSON.stringify(t).indexOf(e.ActivePage),expression:"JSON.stringify(lv1item).indexOf(ActivePage) !== -1"}]},e._l(t.child,function(t,o){return i("li",{key:o,staticClass:"sidebar-nav-item"},[i("div",{staticClass:"sidebar-nav-child-menu"},[i("a",{class:e.nowPage===t.index?"active nav-item-icon":"nav-item-icon",attrs:{href:"javascript:;"},on:{mouseover:function(i){e.HoverSate(t.index)},mouseout:function(t){e.HoverSate(-1)},click:function(i){e.navRoute(t)}}},[e.isCollapse?i("span",{class:t.iconfont}):i("span",{staticClass:"nav-content"},[e._v(e._s(t.name))])]),i("transition",{attrs:{name:"fade"}},[e.isCollapse?i("a",{directives:[{name:"show",rawName:"v-show",value:e.hoverActiveIndex===t.index,expression:"hoverActiveIndex === item.index"}],staticClass:"nav-item-tip",attrs:{href:"javascript:;"}},[i("i",{staticClass:"iconfont icon-point"}),e._v(e._s(t.name)+"\n                ")]):e._e()])],1)])})):e._e()])],1)}))])},b=[],v={name:"TheSidebar",data:function(){return{navList:[{index:"home",iconfont:"iconfont icon-shouye",name:"首页"},{index:"sjzt",iconfont:"iconfont icon-shenjizhuanti",name:"审计专题",child:[{index:"yktl",iconfont:"iconfont icon-yangkataoli",name:"养卡套利"},{index:"zdtl",iconfont:"iconfont icon-zhongduantaol",name:"社会渠道终端套利"},{index:"yjkglwg",iconfont:"iconfont icon-youjiaqia",name:"有价卡管理违规"},{index:"khqf",iconfont:"iconfont icon-kehuqianfei",name:"客户欠费"},{index:"ygycywcz",iconfont:"iconfont icon-yuangongyichang",name:"员工异常业务操作"},{index:"dzqglwg",iconfont:"iconfont icon-dzqglwg",name:"电子券管理违规"},{index:"llglwg",iconfont:"iconfont icon-llglwg",name:"流量管理违规"}]},{index:"sjgj",iconfont:"iconfont icon-shenjigenjin",name:"审计跟进",child:[{index:"zgxx",iconfont:"iconfont icon-zhenggaixinxi",name:"整改信息"},{index:"wzxx",iconfont:"iconfont icon-wenzexinxi",name:"问责信息"}]},{index:"ywgl",iconfont:"iconfont icon-yewuguanli",name:"业务管理",child:[{index:"xqgl",iconfont:"iconfont icon-fabuxuqiu",name:"需求管理"},{index:"sjkg",iconfont:"iconfont icon-shenjikaiguan",name:"审计开关"},{index:"bgxz",iconfont:"iconfont icon-baogaoxaizai",name:"报告下载"},{index:"csgl",iconfont:"iconfont icon-canshuguanli",name:"参数管理"}]},{index:"fxjk",iconfont:"iconfont icon-yewugjianongjiyujing",name:"风险监控",child:[{index:"qfgl",iconfont:"iconfont icon-arrears-status",name:"欠费管理"},{index:"zgbl",iconfont:"iconfont icon-zhangben",name:"账本管理"},{index:"yxzzgl",iconfont:"iconfont icon-canshuguanli",name:"营销资源管理"},{index:"kdgl",iconfont:"iconfont icon-kuandaitianchong",name:"宽带管理"},{index:"wlwgl",iconfont:"iconfont icon-iotwulianwang",name:"物联网管理"},{index:"ykgl",iconfont:"iconfont icon-ykgl",name:"养卡管理"}]},{index:"grgzq",iconfont:"iconfont icon-gerengongzuoqu",name:"个人工作区",child:[{index:"sjbgys",iconfont:"iconfont icon-shenjibaogaoyushen",name:"审计报告预审"},{index:"qxcx",iconfont:"iconfont icon-quanxianchaxun",name:"权限查询"},{index:"rzcx",iconfont:"iconfont icon-rizhi",name:"日志查询"},{index:"sjzlgl",iconfont:"iconfont icon-shujuzhiliang",name:"数据质量管理"},{index:"fileModelConfig",iconfont:"iconfont icon-shujuzhiliang",name:"报告模板配置"}]}],hoverActiveIndex:-1,clientWidth:document.body.clientWidth,nowPage:sessionStorage.getItem("activePage"),ActivePage:sessionStorage.getItem("activePage"),isCollapse:Boolean}},computed:{},methods:{HoverSate:function(e){this.hoverActiveIndex=e},navRoute:function(e){this.ActivePage=e.index,e.child||(sessionStorage.setItem("activePage",e.index),window.location.href="".concat("/"===this.$baseUrl?"/views/":this.$baseUrl).concat(e.index,"/index.html"))}},created:function(){this.clientWidth<=1366?this.isCollapse=!0:this.isCollapse=!1},mounted:function(){var e=this;window.addEventListener("resize",function(t){e.clientWidth=document.body.clientWidth,e.clientWidth<=1366?e.isCollapse=!0:e.isCollapse=!1})}},w=v,y=(i("f14d"),Object(p["a"])(w,g,b,!1,null,"2ce6d990",null));y.options.__file="TheSidebar.vue";var T=y.exports,x={name:"TheLayout",components:{TheHeader:h,TheSidebar:T}},C=x,F=(i("8f07"),Object(p["a"])(C,l,s,!1,null,null,null));F.options.__file="TheLayout.vue";var D=F.exports,k=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"main-content-tab"},[i("el-tabs",{style:{height:e.tabHeight+"px"},attrs:{"tab-position":"left",type:"border-card"},on:{"tab-click":e.changeTab},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[i("el-tab-pane",{attrs:{name:"Word"}},[i("span",{attrs:{slot:"label"},slot:"label"},[i("i",{staticClass:"iconfont icon-dq-text"},[e._v(" ")]),e._v("文本类模板")]),e.WordTabVisiable?i("tab-content"):e._e()],1),i("el-tab-pane",{attrs:{name:"Excel"}},[i("span",{attrs:{slot:"label"},slot:"label"},[i("i",{staticClass:"iconfont icon-baobiaobiaoweiguanli"},[e._v(" ")]),e._v("报表类模板")]),e.ExcelTabVisiable?i("tab-content"):e._e()],1)],1)],1)},E=[],O=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"main-tab-content"},[i("el-row",[i("el-col",{attrs:{span:20}},[i("el-form",{attrs:{inline:!0,model:e.searchForm,size:"mini"}},[i("el-form-item",{attrs:{label:"审计专题"}},[i("el-select",{attrs:{name:"subjectId"},model:{value:e.searchForm.subjectId,callback:function(t){e.$set(e.searchForm,"subjectId",t)},expression:"searchForm.subjectId"}},e._l(e.subjectList,function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})}))],1),i("el-form-item",{attrs:{label:"模板类型"}},[i("el-select",{attrs:{placeholder:"模板类型",name:"modelTypeId"},model:{value:e.searchForm.modelTypeId,callback:function(t){e.$set(e.searchForm,"modelTypeId",t)},expression:"searchForm.modelTypeId"}},e._l(e.tplTypeList,function(e,t){return i("el-option",{key:t,attrs:{label:e.modelTypeName,value:e.modelTypeId}})}))],1)],1)],1),i("el-col",{staticClass:"clearfix",attrs:{span:4}},[i("div",{staticClass:"float-r"},[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.onSearch}},[e._v("查询")]),i("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("导入")])],1)])],1),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],staticStyle:{width:"100%"},attrs:{"element-loading-spinner":"el-icon-loading","element-loading-text":"数据加载中",data:e.tableData,height:e.tableHeight,stripe:""}},[i("el-table-column",{attrs:{prop:"modelTypeName",label:"模板类型",width:"180",align:"center"}}),i("el-table-column",{attrs:{prop:"versions",label:"模板版本",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-select",{attrs:{name:t.row.rowCode,size:"mini"},on:{change:function(i){e.switchVersion(t)}},model:{value:t.row.selected,callback:function(i){e.$set(t.row,"selected",i)},expression:"scope.row.selected"}},e._l(t.row.versionList,function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})}))]}}])}),i("el-table-column",{attrs:{prop:"isOfficial",label:"正式版本",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){return[e.row.isOfficial?i("i",{staticClass:"color-primary iconfont icon-shi"}):i("i",{staticClass:"color-primary iconfont icon-fou"})]}}])}),i("el-table-column",{attrs:{prop:"isDefault",label:"默认版本",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){return[e.row.isDefault?i("i",{staticClass:"color-primary iconfont icon-shi"}):i("i",{staticClass:"color-primary iconfont icon-fou"})]}}])}),i("el-table-column",{attrs:{prop:"reviser",label:"修改人",align:"center"}}),i("el-table-column",{attrs:{prop:"revisionTime",label:"修改时间",align:"center"}}),i("el-table-column",{attrs:{prop:"effectiveTime",label:"生效起始审计月",align:"center"}}),i("el-table-column",{attrs:{prop:"operate",label:"操作",width:"240",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"warning",icon:"el-icon-edit",size:"mini"},on:{click:function(i){e.eidtVersion(t)}}}),i("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(i){e.deleteVersion(t)}}}),i("el-button",{attrs:{type:"success",icon:"el-icon-download",size:"mini"},on:{click:function(i){e.downloadTpl(t)}}}),i("el-button",{attrs:{type:"primary",size:"mini",disabled:Boolean(t.row.isDefault)},on:{click:function(i){e.setDefault(t)}}},[e._v("设为默认版本")])]}}])})],1),i("el-dialog",{attrs:{width:"30%",title:"导入模板","close-on-click-modal":!1,"close-on-press-escape":!1,visible:e.dialogFormVisible},on:{opened:function(t){e.resetForm("importForm")},"update:visible":function(t){e.dialogFormVisible=t}}},[i("el-form",{ref:"importForm",attrs:{size:"small",model:e.importForm,"label-width":"70px"}},[i("el-form-item",{attrs:{prop:"subjectId",label:"审计专题"}},[i("el-select",{model:{value:e.importForm.subjectId,callback:function(t){e.$set(e.importForm,"subjectId",t)},expression:"importForm.subjectId"}},e._l(e.subjectList,function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})}))],1),i("el-form-item",{attrs:{prop:"modelTypeId",label:"模板类型"}},[i("el-select",{attrs:{disabled:e.importTplTypeDisabled},model:{value:e.importForm.modelTypeId,callback:function(t){e.$set(e.importForm,"modelTypeId",t)},expression:"importForm.modelTypeId"}},e._l(e.importTplTypeList,function(e,t){return i("el-option",{key:t,attrs:{label:e.modelTypeName,value:e.modelTypeId}})}))],1),i("el-form-item",{attrs:{prop:"fileNameId",label:"模板文件"}},[i("el-select",{attrs:{disabled:e.importTplFileListDisabled,change:"fileChange(importTplFileList)"},model:{value:e.importForm.fileNameId,callback:function(t){e.$set(e.importForm,"fileNameId",t)},expression:"importForm.fileNameId"}},e._l(e.importTplFileList,function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})}))],1)],1),i("div",{staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),i("el-button",{attrs:{size:"small",type:"primary",disabled:e.importDisableState},on:{click:function(t){return t.stopPropagation(),e.confirmImport(t)}}},[e._v("确 认")])],1)],1),e.dialogUploadVisible?i("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.isUploading,expression:"isUploading"}],attrs:{center:"",visible:e.dialogUploadVisible,width:"30%",title:"请确认模板内容无误，否则需要重新导入","close-on-click-modal":!1,"close-on-press-escape":!1,"element-loading-spinner":"el-icon-loading","element-loading-text":"文件导入中"},on:{"update:visible":function(t){e.dialogUploadVisible=t}}},[i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small",disabled:e.isUploading},on:{click:function(t){e.dialogUploadVisible=!1}}},[e._v("取 消")]),i("el-upload",{staticClass:"upload",attrs:{action:"/cmca/fileModelConfig/webUploader",name:"file",accept:"Word"===e.category?".doc, .docx":".xlsx",data:e.importData,"show-file-list":!1,"before-upload":e.uploading,"on-success":e.importSuccess,"on-error":e.importError}},[i("el-button",{attrs:{size:"small",type:"primary",disabled:e.isUploading}},[e._v("确 定")])],1)],1)]):e._e(),i("el-dialog",{attrs:{center:"",width:"30%",title:"提示","close-on-click-modal":!1,"close-on-press-escape":!1,visible:e.dialogSetDefaultVisible},on:{"update:visible":function(t){e.dialogSetDefaultVisible=t}}},[i("p",{staticClass:"demonstration"},[e._v("设为默认模板后，系统将根据此版本生成对应专题文件，您确定要把此版本设置为默认版本吗？")]),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogSetDefaultVisible=!1}}},[e._v("取 消")]),i("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.affirmSetDefault}},[e._v("确 认")])],1)])],1)},_=[],I=(i("b5aa"),i("701f")),V=(i("25d7"),{name:"MainTabContent",data:function(){return{searchForm:{subjectId:"",modelTypeId:""},importForm:{subjectId:"",modelTypeId:"",fileNameId:""},subjectList:[],tplTypeList:[],tableData:null,tableLoading:!0,dialogFormVisible:!1,importTplTypeList:[],importTplTypeDisabled:!0,importTplFileList:[],importTplFileListDisabled:!0,importDisableState:!0,dialogUploadVisible:!1,isUploading:!1,dialogSetDefaultVisible:!1,setDefaultVersionScope:null,importData:{category:"",rowCodeVersionId:""}}},computed:Object(r["c"])("fileModelConfig",{tableHeight:function(e){return e.contentHeight-80},category:function(e){return e.category}}),watch:{"searchForm.subjectId":{handler:function(e,t){var i=this;t&&this.$api.fileModelConfig.getTplTypeList({category:this.category,subjectId:this.searchForm.subjectId}).then(function(e){e.modelType.unshift({modelTypeId:"all",modelTypeName:"全部"}),i.searchForm.modelTypeId="all",i.tplTypeList=e.modelType}).catch(function(e){i.$message.error(e)})}},importForm:{handler:function(e,t){e.subjectId&&e.modelTypeId&&e.fileNameId?this.importDisableState=!1:this.importDisableState=!0},deep:!0},"importForm.subjectId":{handler:function(e,t){var i=this;this.importForm.modelTypeId="",t||(this.importTplTypeDisabled=!1),e&&this.$api.fileModelConfig.getTplTypeList({category:this.category,subjectId:this.importForm.subjectId}).then(function(e){i.importTplTypeList=e.modelType,i.importForm.modelTypeId=e.modelType[0].modelTypeId}).catch(function(e){i.$message.error(e)})}},"importForm.modelTypeId":{handler:function(e,t){e&&this.loadTplFileList()}}},methods:Object(a["a"])({},Object(r["b"])("fileModelConfig",["updateSubjectId","ShowMainEdit","updateEditTplInfo"]),{resetForm:function(e){this.importTplTypeDisabled=!0,this.importTplFileListDisabled=!0,this.$refs[e].resetFields()},onSearch:function(){this.updateSubjectId(this.searchForm.subjectId),this.loadDetailTable()},loadDetailTable:function(){var e=this;this.tableLoading=!0;var t=JSON.parse(JSON.stringify(this.searchForm));t.category=this.category,this.$api.fileModelConfig.getDetailTableData(t).then(function(t){t.tableData.forEach(function(e,t){e.selected=e.defaultVersionId}),e.tableData=t.tableData,e.tableLoading=!1}).catch(function(t){e.$message.error(t)})},initTabContent:function(){var e=Object(I["a"])(regeneratorRuntime.mark(function e(){var t,i,o=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$api.fileModelConfig.getSubjectList().catch(function(e){o.$message.error(e)});case 2:return t=e.sent,this.subjectList=t.subjectList,this.searchForm.subjectId=4,this.updateSubjectId(this.searchForm.subjectId),e.next=8,this.$api.fileModelConfig.getTplTypeList({category:this.category,subjectId:this.searchForm.subjectId}).catch(function(e){o.$message.error(e)});case 8:i=e.sent,i.modelType.unshift({modelTypeId:"all",modelTypeName:"全部"}),this.tplTypeList=i.modelType,this.searchForm.modelTypeId="all",this.loadDetailTable();case 13:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),switchVersion:function(e,t){var i=this,o=t?e.row.defaultVersionId:e.row.selected,n=this.tableData[e.$index];this.$api.fileModelConfig.getTplVersionData({modelTypeId:this.searchForm.modelTypeId,rowCode:e.row.rowCode,versionId:o}).then(function(e){var t=e.verisonData;for(var i in t)t.hasOwnProperty(i)&&n.hasOwnProperty(i)&&(n[i]=t[i])}).catch(function(e){i.$message.error(e)})},eidtVersion:function(e){this.ShowMainEdit(),this.updateEditTplInfo(e.row)},deleteVersion:function(e){var t=this;e.row.isDefault?this.$alert("该模板为默认版本，不能删除","提示",{confirmButtonText:"确定"}):this.$confirm("您确认要删除该模板吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var i={rowCode:e.row.rowCode,versionId:e.row.selected};t.$api.fileModelConfig.deleteTplVersion(i).then(function(i){if(i.deleteInfo){t.$message({type:"success",message:"删除成功!"});var o=t.tableData[e.$index].versionList;o.forEach(function(t,i){t.id===e.row.selected&&o.splice(i,1)}),e.row.selected=e.row.defaultVersionId,t.switchVersion(e,!0)}else t.$message({type:"error",message:"删除失败!"})}).catch(function(e){t.$message.error(e)})})},downloadTpl:function(e){var t=e.row.rowCode,i=e.row.selected;window.open("".concat(this.$baseUrl,"fileModelConfig/downLoadModelFile?rowCode=").concat(t,"&versionId=").concat(i,"&category=").concat(this.category))},setDefault:function(e){e.row.isDefault||(this.dialogSetDefaultVisible=!0,this.setDefaultVersionScope=e)},affirmSetDefault:function(){var e=this,t={category:this.category,rowCode:this.setDefaultVersionScope.row.rowCode,versionId:this.setDefaultVersionScope.row.selected};this.$api.fileModelConfig.setDefaultTplVersion(t).then(function(t){e.dialogSetDefaultVisible=!1,e.switchVersion(e.setDefaultVersionScope)}).catch(function(t){e.$message.error(t)})},loadTplFileList:function(){var e=this;this.importForm.subjectId&&this.importForm.modelTypeId?(this.importTplFileListDisabled=!1,this.$api.fileModelConfig.getTplFileList({category:this.category,subjectId:this.importForm.subjectId,modelTypeId:this.importForm.modelTypeId}).then(function(t){e.importTplFileList=t.fileList,e.importForm.fileNameId=t.fileList[0].id}).catch(function(t){e.$message.error(t)})):this.importTplFileList=null},confirmImport:function(){var e=this;setTimeout(function(){e.dialogFormVisible=!1,e.dialogUploadVisible=!0,e.importData.rowCodeVersionId=e.importForm.fileNameId,e.importData.category=e.category},0)},uploading:function(){this.isUploading=!0},importSuccess:function(){var e=this;this.$message({type:"success",message:"导入成功!"}),setTimeout(function(){e.loadDetailTable(),e.isUploading=!1,e.dialogUploadVisible=!1},0)},importError:function(){var e=this;this.$alert("导入失败，请重新导入!",{confirmButtonText:"确定",callback:function(t){e.isUploading=!1,e.dialogFormVisible=!0,e.dialogUploadVisible=!1}})}}),mounted:function(){this.initTabContent()}}),L=V,M=(i("a7cf"),Object(p["a"])(L,O,_,!1,null,"c93aa9fa",null));M.options.__file="MainTabContent.vue";var S=M.exports,$={name:"MainTab",data:function(){return{activeTab:"Word",WordTabVisiable:!0,ExcelTabVisiable:!1,typeList:{textTypes:[{id:"all",name:"全部"}],statementTypes:[{id:"all",name:"全部"}]}}},computed:{tabHeight:function(){return this.$store.state.fileModelConfig.contentHeight}},components:{TabContent:S},methods:Object(a["a"])({},Object(r["b"])("fileModelConfig",["switchTab"]),{initTab:function(){var e;"Word"===this.activeTab?(this.WordTabVisiable=!0,this.ExcelTabVisiable=!1,e="文本类模板"):(this.ExcelTabVisiable=!0,this.WordTabVisiable=!1,e="报表类模板"),this.switchTab({tabName:e,category:this.activeTab})},changeTab:function(e){var t=e.$slots.label[0].elm.innerText.substring(1);this.WordTabVisiable=!0,this.ExcelTabVisiable=!0,this.switchTab({tabName:t,category:this.activeTab})}}),created:function(){this.initTab()}},j=$,P=(i("233e"),Object(p["a"])(j,k,E,!1,null,"0b75f178",null));P.options.__file="MainTab.vue";var z=P.exports,U=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"main-edit-content"},[i("el-row",[i("el-col",{attrs:{span:14}},[i("el-form",{attrs:{inline:!0,size:"mini"}},[i("el-form-item",{attrs:{label:"模板版本"}},[i("el-select",{model:{value:e.selectedTplVersion,callback:function(t){e.selectedTplVersion=t},expression:"selectedTplVersion"}},e._l(e.tplVersionList,function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})}))],1),"Excel"===e.category?i("el-form-item",{attrs:{label:"报表位置"}},[i("el-select",{model:{value:e.selectedExcelSheet,callback:function(t){e.selectedExcelSheet=t},expression:"selectedExcelSheet"}},e._l(e.sheetList,function(e,t){return i("el-option",{key:t,attrs:{label:e.sheetName,value:e.sheetOrder}})}))],1):e._e()],1)],1),i("el-col",{staticClass:"clearfix",attrs:{span:10}},[i("div",{staticClass:"float-r"},[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.openUpdateDialog}},[e._v("更新配置")]),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.openPreDialog}},[e._v("预生成")]),i("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:e.exportConfigFile}},[e._v("导出配置文件")]),i("el-upload",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.isUploading,expression:"isUploading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"upload",attrs:{action:"/cmca/fileModelConfig/inputConf",accept:".sql","show-file-list":!1,"before-upload":e.uploading,"on-success":e.importSuccess,"on-error":e.importError}},[i("el-button",{attrs:{type:"primary",plain:"",size:"mini"}},[e._v("导入配置文件")])],1)],1)])],1),i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isTplPreviewLoading,expression:"isTplPreviewLoading"}],style:{height:e.mainHeight-80+"px"},attrs:{"element-loading-spinner":"el-icon-loading","element-loading-text":"模板加载中"}},[i("div",{ref:"initPreview",staticClass:"review-content"})]),i("update-dialog",{ref:"editDialog",attrs:{"tpl-version":e.selectedTplVersion,"sheet-order":e.selectedExcelSheet}}),i("el-dialog",{attrs:{title:"预生成",visible:e.preDialogVisible,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.preDialogVisible=t}}},[e.preDialogVisible?i("pre-content",{attrs:{"tpl-version":e.selectedTplVersion,"sheet-order":e.selectedExcelSheet}}):e._e()],1)],1)},N=[],H=(i("cd2e"),i("8c56")),q=i.n(H),R=(i("9f45"),i("f8d1")),B={namespaced:!0,state:{contentHeight:document.body.clientHeight-127,category:"",activeTab:"",subjectId:"",editContentVisible:!1,editTplInfo:null,updateDialogVisible:!1,editFormData:null,blockData:null,tplOperation:"",reuseEditData:null},mutations:{heightResize:function(e,t){e.contentHeight=t-127},switchTab:function(e,t){e.activeTab=t.tabName,e.category=t.category},updateSubjectId:function(e,t){e.subjectId=t},ShowMainEdit:function(e){e.editContentVisible=!0},HideMainEdit:function(e){e.editContentVisible=!1},showUpdateDialogVisible:function(e){e.updateDialogVisible=!0},hideUpdateDialogVisible:function(e){e.updateDialogVisible=!1},initEditFormData:function(e,t){e.editFormData=t},updateEditTplInfo:function(e,t){e.editTplInfo=t},updateBlockData:function(e,t){e.blockData=t},updateTplOperation:function(e,t){e.tplOperation=t},setReuseEditData:function(e,t){e.reuseEditData=t}},actions:{heightResize:function(e,t){e.commit("heightResize",t)},switchTab:function(e,t){e.commit("switchTab",t)},updateSubjectId:function(e,t){e.commit("updateSubjectId",t)},initEditFormData:function(e,t){e.commit("initEditFormData",t)},ShowMainEdit:function(e){e.commit("ShowMainEdit")},HideMainEdit:function(e){e.commit("HideMainEdit")},showUpdateDialogVisible:function(e){e.commit("showUpdateDialogVisible")},hideUpdateDialogVisible:function(e){e.commit("hideUpdateDialogVisible")},updateEditTplInfo:function(e,t){e.commit("updateEditTplInfo",t)},updateBlockData:function(e,t){e.commit("updateBlockData",t)},updateTplOperation:function(e,t){e.commit("updateTplOperation",t)},initReuseEditData:function(e,t){e.commit("setReuseEditData",t)}}},W=B;R["default"].use(r["a"]);var A=new r["a"].Store({modules:{fileModelConfig:W}}),J=i("7f43"),Q=i.n(J),G=i("0427"),K=i.n(G);Q.a.defaults.timeout=25e3,Q.a.defaults.baseURL="/cmca/",Q.a.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded;charset=UTF-8",Q.a.interceptors.request.use(function(e){return"post"===e.method&&(e.data=K.a.stringify(e.data)),e},function(e){return Promise.reject(e)}),Q.a.interceptors.response.use(function(e){return e.data},function(e){if(e&&e.response)switch(e.response.status){case 400:e.message="错误请求，状态码:400";break;case 401:e.message="未授权，请重新登录，状态码:401";break;case 403:e.message="拒绝访问，状态码:403";break;case 404:e.message="请求错误,未找到该资源，状态码:404";break;case 405:e.message="请求方法未允许，状态码:405";break;case 408:e.message="请求超时，状态码:408";break;case 500:e.message="服务器端出错，状态码:500";break;case 501:e.message="网络未实现，状态码:501";break;case 502:e.message="网络错误，状态码:502";break;case 503:e.message="服务不可用，状态码:503";break;case 504:e.message="网络超时，状态码:504";break;case 505:e.message="http版本不支持该请求，状态码:505";break;default:e.message="连接错误".concat(e.response.status)}else e.message="连接到服务器失败";return Promise.reject(e.message)});var X=Q.a,Y={getSubjectList:function(e){return X.get("/fileModelConfig/getSubject")},getTplTypeList:function(e){return X.get("/fileModelConfig/getModeltype",{params:e})},getDetailTableData:function(e){return X.get("/fileModelConfig/getTableData",{params:e})},getTplVersionData:function(e){return X.get("/fileModelConfig/getVersionData",{params:e})},deleteTplVersion:function(e){return X.get("/fileModelConfig/deleteByVersion",{params:e})},downLoadVersion:function(e){return X.get("/fileModelConfig/downLoadModelFile",{params:e})},setDefaultTplVersion:function(e){return X.get("/fileModelConfig/setDefaultVersion",{params:e})},getTplFileList:function(e){return X.get("/fileModelConfig/getFileName",{params:e})},getSheetList:function(e){return X.get("/fileModelConfig/getExcelSheetName",{params:e})},exportConfigFile:function(e){return X.get("/fileModelConfig/outPutConf",{params:e})},getPreviewTplFile:function(e){return X.get("/fileModelConfig/getModelTxtNoHandle",{params:e})},getEditPreviewFile:function(e){return X.get("/fileModelConfig/getModelTxtHandleOne",{params:e})},getReusePreviewFile:function(e){return X.get("/fileModelConfig/getModelTxtHandleTwo",{params:e})},getEditFormData:function(e){return X.get("/fileModelConfig/getEditInfoData",{params:e})},postEditData:function(e){return X.post("/fileModelConfig/updateFileModel",e)},getPreviewPreFile:function(e){return X.get("/fileModelConfig/getModelTxtHandlePre",{params:e})},releaseVersion:function(e){return X.get("/fileModelConfig/setFullVersion",{params:e})},downLoadPreFile:function(e){return X.get("/fileModelConfig/downLoad",{params:e})}},Z={fileModelConfig:Y};i("bf98"),i("7dd0"),i("5414");R["default"].use(q.a),R["default"].prototype.$baseUrl="/cmca/",R["default"].prototype.$api=Z;var ee=function(e){var t=R["default"].extend(e),i=(new t).$mount();return i.$el},te=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{staticClass:"edit-dialog",attrs:{title:"更新模板",visible:e.updateDialogVisible,"close-on-click-modal":!1,"close-on-press-escape":!1,"before-close":e.closeTip},on:{open:e.openUpdateDialog}},[i("el-row",{style:{height:e.mainHeight-90+"px"}},[i("el-col",{staticStyle:{height:"100%"},attrs:{span:e.isOperation?12:24}},[i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isUpdateTplLoading,expression:"isUpdateTplLoading"}],ref:"editTplPreview",staticClass:"edit-review-container",attrs:{"element-loading-spinner":"el-icon-loading","element-loading-text":"模板加载中"}})]),e.isOperation?i("el-col",{directives:[{name:"loading",rawName:"v-loading",value:e.operationlLoading,expression:"operationlLoading"}],staticStyle:{height:"100%"},attrs:{"element-loading-spinner":"el-icon-loading","element-loading-text":"数据加载中",span:e.isOperation?12:0}},["edit"===e.operation&&"Word"===e.category?i("edit-form",{ref:"editForm",attrs:{"tpl-version":e.tplVersion,"form-model":e.wordEditForm}},[i("form-item-title",{attrs:{iconColor:"#FE9455"}},[e._v("控制段落间合并")]),i("el-form-item",{attrs:{prop:"mergeLast"}},[i("el-checkbox",{attrs:{"true-label":1,"false-label":0},model:{value:e.wordEditForm.mergeLast,callback:function(t){e.$set(e.wordEditForm,"mergeLast",t)},expression:"wordEditForm.mergeLast"}},[e._v("与上一段落合并")])],1),i("form-item-title",{attrs:{iconColor:"#AD54FF"}},[e._v("控制该段落取值逻辑")]),i("el-form-item",{attrs:{prop:"querySql",label:"SQL逻辑"}},[i("el-input",{attrs:{type:"textarea",rows:5},model:{value:e.wordEditForm.querySql,callback:function(t){e.$set(e.wordEditForm,"querySql",t)},expression:"wordEditForm.querySql"}})],1),i("form-item-title",[e._v("控制该段落是否显示")]),i("el-form-item",{attrs:{prop:"showType",label:"显示类型"}},[i("el-select",{attrs:{placeholder:"模板类型"},model:{value:e.wordEditForm.showType,callback:function(t){e.$set(e.wordEditForm,"showType",t)},expression:"wordEditForm.showType"}},e._l(e.showTypeList,function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})}))],1),i("transition",{attrs:{name:"el-zoom-in-top"}},[i("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1===e.wordEditForm.showType,expression:"wordEditForm.showType === 1"}],attrs:{prop:"showSql",label:"SQL逻辑"}},[i("el-input",{attrs:{type:"textarea",rows:5},model:{value:e.wordEditForm.showSql,callback:function(t){e.$set(e.wordEditForm,"showSql",t)},expression:"wordEditForm.showSql"}})],1)],1)],1):e._e(),"edit"===e.operation&&"Excel"===e.category?i("edit-form",{ref:"editForm",attrs:{"tpl-version":e.tplVersion,"form-model":e.excelEditForm}},[i("form-item-title",{attrs:{iconColor:"#FE9455"}},[e._v("控制报表类型")]),i("el-row",[i("el-col",{attrs:{span:10}},[9===e.subjectId?i("el-form-item",{attrs:{prop:"audTrmOption",label:"审计月参数"}},[i("el-select",{model:{value:e.excelEditForm.audTrmOption,callback:function(t){e.$set(e.excelEditForm,"audTrmOption",t)},expression:"excelEditForm.audTrmOption"}},e._l(e.audTrmOptionList,function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})}))],1):e._e()],1),i("el-col",{attrs:{span:10}},[i("el-form-item",{attrs:{prop:"isWideTb"}},[i("el-checkbox",{attrs:{"true-label":1,"false-label":0},model:{value:e.excelEditForm.isWideTb,callback:function(t){e.$set(e.excelEditForm,"isWideTb",t)},expression:"excelEditForm.isWideTb"}},[e._v("循环多月数据")])],1)],1)],1),i("transition",{attrs:{name:"el-zoom-in-top"}},[e.excelEditForm.isWideTb?i("el-row",[i("el-col",{attrs:{span:10}},[i("el-form-item",{attrs:{prop:"wideTbMonth",label:"起始月"}},[i("el-input",{model:{value:e.excelEditForm.wideTbMonth,callback:function(t){e.$set(e.excelEditForm,"wideTbMonth",t)},expression:"excelEditForm.wideTbMonth"}})],1)],1),i("el-col",{attrs:{span:10}},[i("el-form-item",{attrs:{prop:"wideTbCol",label:"公共开始列"}},[i("el-input",{model:{value:e.excelEditForm.wideTbCol,callback:function(t){e.$set(e.excelEditForm,"wideTbCol",t)},expression:"excelEditForm.wideTbCol"}})],1)],1)],1):e._e()],1),i("form-item-title",{attrs:{iconColor:"#AD54FF"}},[e._v("控制报表取数逻辑")]),i("el-form-item",{attrs:{prop:"querySql",label:"SQL编辑"}},[i("el-input",{attrs:{type:"textarea",rows:5},model:{value:e.excelEditForm.querySql,callback:function(t){e.$set(e.excelEditForm,"querySql",t)},expression:"excelEditForm.querySql"}})],1)],1):e._e(),"reuse"===e.operation?i("edit-reuse"):e._e()],1):e._e()],1)],1)},ie=[],oe=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"form-item-title"},[i("h3",[i("span",{staticClass:"title-icon",style:{backgroundColor:e.iconColor}}),e._t("default",[e._v("表单项标题")])],2)])},ne=[],ae={name:"formItemTitle",props:{iconColor:{default:"#268BFF"}}},re=ae,le=(i("6f88"),Object(p["a"])(re,oe,ne,!1,null,"0d6a642e",null));le.options.__file="VFormTitle.vue";var se=le.exports,ce=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"reuse-container"},[i("el-form",{attrs:{size:"mini",inline:!0,model:e.reuseForm,"label-width":"70px"}},[i("el-row",[i("el-col",{attrs:{span:"Excel"===e.category?8:10}},[i("el-form-item",{attrs:{label:"模板版本"}},[i("el-select",{model:{value:e.reuseForm.versionId,callback:function(t){e.$set(e.reuseForm,"versionId",t)},expression:"reuseForm.versionId"}},e._l(e.tplVersionList,function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})}))],1)],1),"Excel"===e.category?i("el-col",{attrs:{span:"Excel"===e.category?8:0}},["Excel"===e.category?i("el-form-item",{attrs:{label:"报表位置"}},[i("el-select",{model:{value:e.reuseForm.sheetOrder,callback:function(t){e.$set(e.reuseForm,"sheetOrder",t)},expression:"reuseForm.sheetOrder"}},e._l(e.sheetList,function(e,t){return i("el-option",{key:t,attrs:{label:e.sheetName,value:e.sheetOrder}})}))],1):e._e()],1):e._e(),i("el-col",{attrs:{span:"Excel"===e.category?8:10}},[i("el-form-item",{attrs:{label:"段落位置"}},[i("el-select",{model:{value:e.reuseForm.blockOrder,callback:function(t){e.$set(e.reuseForm,"blockOrder",t)},expression:"reuseForm.blockOrder"}},e._l(e.blockList,function(e,t){return i("el-option",{key:t,attrs:{label:e.blockName,value:e.blockOrder}})}))],1)],1)],1)],1),i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],ref:"reusePrview",attrs:{"element-loading-spinner":"el-icon-loading","element-loading-text":"模板加载中"}})],1)},de=[],ue={name:"reuse-content",data:function(){return{reuseForm:{versionId:"",sheetOrder:"",blockOrder:""},sheetList:[{sheetOrder:1,sheetName:"test"}],blockList:[],isLoading:!1}},computed:Object(r["c"])("fileModelConfig",{category:function(e){return e.category},rowCode:function(e){return e.editTplInfo.rowCode},tplVersionList:function(e){return e.editTplInfo.versionList},defaultTplVersion:function(e){return e.editTplInfo.defaultVersionId},blockData:function(e){return e.blockData}}),watch:{"reuseForm.versionId":function(e,t){var i=this;"Excel"===this.category?this.$api.fileModelConfig.getSheetList({rowCode:this.rowCode,versionId:this.reuseForm.versionId}).then(function(e){i.sheetList=e.sheetNameData,i.reuseForm.sheetOrder=e.sheetNameData[0].sheetOrder,i.loadReuseTplPreview()}):this.loadReuseTplPreview()},"reuseForm.sheetOrder":function(e,t){t&&this.loadReuseTplPreview()},"reuseForm.blockOrder":function(e,t){var i=this;this.$confirm("确定复制该段落配置？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e=i.reuseForm;e.category=i.category,e.rowCode=i.rowCode,i.$api.fileModelConfig.getEditFormData(e).then(function(e){var t=i;function o(){return n.apply(this,arguments)}function n(){return n=Object(I["a"])(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,t.updateTplOperation("edit");case 2:t.initReuseEditData(e.editInfoData);case 3:case"end":return i.stop()}},i,this)})),n.apply(this,arguments)}o()}).catch(function(e){i.$message.error(e)})}).catch(function(){})},blockData:{handler:function(e,t){e.blockOrder!==t.blockOrder&&(this.reuseForm.versionId=this.defaultTplVersion)},deep:!0}},methods:Object(a["a"])({},Object(r["b"])("fileModelConfig",["initReuseEditData","updateTplOperation"]),{loadReuseTplPreview:function(){var e=this;this.isLoading=!0,this.$refs.reusePrview.innerHTML="",this.$nextTick(function(){e.$api.fileModelConfig.getReusePreviewFile({versionId:e.tplVersion,sheetOrder:e.excelSheet,rowCode:e.rowCode,category:e.category}).then(function(t){e.$refs.reusePrview.scrollTop=0;var i=ee({template:"".concat(t.txtHandleTwo.txt),data:function(){return{style:t.txtHandleTwo.style}}});e.$refs.reusePrview.appendChild(i),e.reuseForm.blockOrder="",e.blockList=t.txtHandleTwo.blockList,e.isLoading=!1}).catch(function(t){e.$message.error(t)})})}}),created:function(){this.reuseForm.versionId=this.defaultTplVersion}},fe=ue,pe=(i("4199"),Object(p["a"])(fe,ce,de,!1,null,"10346d86",null));pe.options.__file="MainEditUpdateDialogReuse.vue";var me=pe.exports,he=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{ref:"editFormContainer",staticClass:"edit-form-container"},[i("el-form",{ref:"editForm",attrs:{model:e.editForm,"label-width":"120px",size:"mini"}},[e._t("default"),i("el-form-item",{staticStyle:{"text-align":"center"},attrs:{size:"large"}},[i("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.saveEdit}},[e._v("保存")]),i("el-button",{attrs:{size:"small"},on:{click:e.clearForm}},[e._v("清除")])],1)],2)],1)},ge=[],be={name:"EditForm",data:function(){return{isLoading:!1,editForm:this.formModel}},props:{tplVersion:{required:!0},formModel:{type:Object,required:!0}},computed:Object(a["a"])({},Object(r["c"])("fileModelConfig",{category:function(e){return e.category},initEditData:function(e){return e.editFormData},rowCode:function(e){return e.editTplInfo.rowCode},blockData:function(e){return e.blockData}}),{newEditDataString:function(){return JSON.stringify(this.editForm)}}),watch:{},methods:Object(a["a"])({},Object(r["b"])("fileModelConfig",["initEditFormData"]),{resetForm:function(e){this.$refs[e].resetFields()},saveEdit:function(){var e=this;if(this.initEditData!=this.newEditDataString){var t=JSON.parse(JSON.stringify(this.editForm));t.rowCode=this.rowCode,t.blockOrder=this.blockData.blockOrder,t.sheetOrder=this.blockData.sheetOrder,t.category=this.category,t.versionId=this.tplVersion,this.$api.fileModelConfig.postEditData(t).then(function(t){e.$message({message:"已保存",type:"success"}),e.initEditFormData(e.newEditDataString)}).catch(function(t){e.$message.error(t)})}else this.$message("表单内容未做更改，不需重复提交")},clearForm:function(){var e=this;this.$confirm("此操作不可恢复，确认清除？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.resetForm("editForm")}).catch(function(){})}}),mounted:function(){var e=this;this.$nextTick(function(){e.$refs.editFormContainer.scrollTop=0})}},ve=be,we=(i("9835"),Object(p["a"])(ve,he,ge,!1,null,"8211fdb0",null));we.options.__file="MainEditUpdateDialogForm.vue";var ye=we.exports,Te={name:"MainEditUpdateDialog",data:function(){return{isUpdateTplLoading:!0,isOperation:!1,operationlLoading:!1,wordEditForm:{querySql:"",showSql:"",mergeLast:0,showType:0},showTypeList:[{id:0,name:"0-一律显示"},{id:1,name:"1-SQL逻辑控制显示"}],excelEditForm:{audTrmOption:"",isWideTb:0,wideTbMonth:"",wideTbCol:"",querySql:""},audTrmOptionList:[{id:-1,name:"-1"},{id:-2,name:"-2"},{id:-3,name:"-3"}]}},computed:Object(a["a"])({},Object(r["c"])("fileModelConfig",{mainHeight:function(e){return e.contentHeight},subjectId:function(e){return e.subjectId},category:function(e){return e.category},updateDialogVisible:function(e){return e.updateDialogVisible},rowCode:function(e){return e.editTplInfo.rowCode},operation:function(e){return e.tplOperation},initEditData:function(e){return e.editFormData},blockData:function(e){return e.blockData},reuseEditData:function(e){return e.reuseEditData}}),{editFormModel:function(){return"Word"===this.category?this.wordEditForm:this.excelEditForm},newEditDataString:function(){return JSON.stringify(this.editFormModel)}}),props:{tplVersion:{required:!0},sheetOrder:{required:!0}},watch:{updateDialogVisible:function(e,t){e||(this.$refs.editTplPreview.innerHTML="",this.isOperation=!1,this.initEditFormData(null))},blockData:{handler:function(e,t){this.initEditForm()},deep:!0},reuseEditData:{handler:function(e,t){for(var i in this.editFormModel)this.editFormModel.hasOwnProperty(i)&&e.hasOwnProperty(i)&&(this.editFormModel[i]=e[i])},deep:!0}},components:{FormItemTitle:se,EditForm:ye,EditReuse:me},methods:Object(a["a"])({},Object(r["b"])("fileModelConfig",["hideUpdateDialogVisible","updateTplOperation","initEditFormData","updateBlockData"]),{editSaveTip:function(){return this.$confirm("配置内容未保存，是否放弃","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"})},loadEditPreviewFile:function(){var e=this;this.$refs.editTplPreview.scrollTop=0,this.$api.fileModelConfig.getEditPreviewFile({versionId:this.tplVersion,rowCode:this.rowCode,category:this.category,sheetOrder:this.sheetOrder}).then(function(t){e.isUpdateTplLoading=!1;var i=e,o=ee({template:"".concat(t.txtHandleOne.txt),data:function(){return{style:t.txtHandleOne.style,blockInfo:null}},methods:{switchBlock:function(e,t){var o=this;this.blockInfo={blockOrder:e[0],sheetOrder:e[1]},i.isOperation?i.blockData.blockOrder!==e[0]?i.initEditData!==i.newEditDataString?i.editSaveTip().then(function(){i.updateBlockData(o.blockInfo),t!==i.operation&&i.updateTplOperation(t)}).catch(function(){}):(i.updateBlockData(this.blockInfo),t!==i.operation&&i.updateTplOperation(t)):t!==i.operation&&i.updateTplOperation(t):(i.isOperation=!0,i.updateBlockData(this.blockInfo),i.updateTplOperation(t))},edit:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.switchBlock(t,"edit")},reuse:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.switchBlock(t,"reuse")}}});e.$refs.editTplPreview.innerHTML="",e.$refs.editTplPreview.appendChild(o)}).catch(function(t){e.$message.error(t)})},openUpdateDialog:function(){var e=this;this.isUpdateTplLoading=!0,this.isOperation=!1,this.$nextTick(function(){e.loadEditPreviewFile()})},closeTip:function(){var e=Object(I["a"])(regeneratorRuntime.mark(function e(t){var i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(i=!0,!this.isOperation||"edit"!==this.operation){e.next=6;break}if(this.initEditData===this.newEditDataString){e.next=6;break}return e.next=5,this.editSaveTip().then(function(){return!0}).catch(function(){return!1});case 5:i=e.sent;case 6:i&&this.hideUpdateDialogVisible();case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),initEditForm:function(){var e=this;this.operationlLoading=!0,this.$api.fileModelConfig.getEditFormData({category:this.category,rowCode:this.rowCode,versionId:this.tplVersion,blockOrder:this.blockData.blockOrder,sheetOrder:this.blockData.sheetOrder}).then(function(t){var i={};if(e.editFormModel){if("edit"===e.operation){for(var o in e.editFormModel)e.editFormModel.hasOwnProperty(o)&&t.editInfoData.hasOwnProperty(o)&&(e.editFormModel[o]=t.editInfoData[o]);i=e.editFormModel}else for(var n in e.editFormModel)e.editFormModel.hasOwnProperty(n)&&t.editInfoData.hasOwnProperty(n)&&(i[n]=t.editInfoData[n]);e.initEditFormData(JSON.stringify(i)),e.operationlLoading=!1}}).catch(function(t){e.$message.error(t)})}})},xe=Te,Ce=(i("0cb6"),Object(p["a"])(xe,te,ie,!1,null,"0db0288e",null));Ce.options.__file="MainEditUpdateDialog.vue";var Fe=Ce.exports,De=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.releaseLoading,expression:"releaseLoading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"main-pre-content",attrs:{"element-loading-spinner":"el-icon-loading","element-loading-text":"发布正式版本"}},[i("el-row",{staticStyle:{"margin-bottom":"10px"}},[i("el-col",{staticStyle:{"text-align":"right"},attrs:{span:6,offset:18}},[i("el-button",{attrs:{type:"primary",size:"mini",disabled:e.disabledState},on:{click:e.releaseVersion}},[e._v("发布正式版本")]),i("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:e.downLoad}},[e._v("下载")])],1)],1),i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],ref:"preTplPreview",staticClass:"pre-review-container",style:{height:e.mainHeight-120+"px"},attrs:{"element-loading-spinner":"el-icon-loading","element-loading-text":"模板加载中"}})],1)},ke=[],Ee={name:"MainEditPreGenerated",data:function(){return{isLoading:!0,disabledState:!1,releaseLoading:!1}},props:{tplVersion:{required:!0},sheetOrder:{required:!0}},computed:Object(a["a"])({},Object(r["c"])("fileModelConfig",{mainHeight:function(e){return e.contentHeight},category:function(e){return e.category},rowCode:function(e){return e.editTplInfo.rowCode}})),methods:{loadPreTpl:function(){var e=this;this.$refs.preTplPreview.scrollTop=0,this.$api.fileModelConfig.getPreviewPreFile({rowCode:this.rowCode,category:this.category,versionId:this.tplVersion,sheetOrder:this.sheetOrder}).then(function(t){e.isLoading=!1;var i=ee({template:"".concat(t.txtHandleOne.txt),data:function(){return{style:t.txtHandleOne.style}}});e.$refs.preTplPreview.innerHTML="",e.$refs.preTplPreview.appendChild(i)}).catch(function(t){e.$message.error(t)})},releaseVersion:function(){var e=this;this.releaseLoading=!0,this.$api.fileModelConfig.releaseVersion({rowCode:this.rowCode,category:this.category,versionId:this.tplVersion}).then(function(t){e.releaseLoading=!1,t.releaseInfo?(e.disabledState=!0,e.$message({type:"success",message:"正式版本发布成功"})):e.$alert("模板未完成编辑，不能发布正式版本","提示",{confirmButtonText:"确定"})}).catch(function(t){e.$message(t)})},downLoad:function(){var e=this;this.$api.fileModelConfig.downLoadPreFile({rowCode:this.rowCode,category:this.category,versionId:this.tplVersion,sheetOrder:this.sheetOrder}).then(function(t){window.open("/".concat(e.$baseUrl,"/fileModelConfig/").concat(t.path))}).catch(function(t){e.$message(t)})}},mounted:function(){this.loadPreTpl()}},Oe=Ee,_e=(i("f4a8"),Object(p["a"])(Oe,De,ke,!1,null,"b1aaed7e",null));_e.options.__file="MainEditPreGenerated.vue";var Ie=_e.exports,Ve={name:"MainEdit",data:function(){return{selectedTplVersion:"",selectedExcelSheet:"",sheetList:[],isUploading:!1,isTplPreviewLoading:!0,preDialogVisible:!1}},computed:Object(r["c"])("fileModelConfig",{mainHeight:function(e){return e.contentHeight},rowCode:function(e){return e.editTplInfo.rowCode},tplVersionList:function(e){return e.editTplInfo.versionList},editTplList:function(e){return e.editTplInfo},category:function(e){return e.category}}),watch:{selectedTplVersion:function(e,t){var i=this;"Excel"===this.category?this.$api.fileModelConfig.getSheetList({rowCode:this.rowCode,versionId:this.selectedTplVersion}).then(function(e){i.sheetList=e.sheetNameData,i.selectedExcelSheet=e.sheetNameData[0].sheetOrder,i.loadPreviewTplFile()}):this.loadPreviewTplFile()},selectedExcelSheet:function(e,t){(0===t||t)&&this.loadPreviewTplFile()}},components:{UpdateDialog:Fe,PreContent:Ie},methods:Object(a["a"])({},Object(r["b"])("fileModelConfig",["showUpdateDialogVisible"]),{loadPreviewTplFile:function(){var e=this;this.isTplPreviewLoading=!0,this.$refs.initPreview.innerHTML="",this.$nextTick(function(){e.$api.fileModelConfig.getPreviewTplFile({versionId:e.selectedTplVersion,sheetOrder:e.selectedExcelSheet,rowCode:e.rowCode,category:e.category}).then(function(t){e.$refs.initPreview.scrollTop=0;var i=ee({template:"".concat(t.txtNoHandle.txt),data:function(){return{style:t.txtNoHandle.style}}});e.$refs.initPreview.appendChild(i),e.isTplPreviewLoading=!1}).catch(function(t){e.$message.error(t)})})},openUpdateDialog:function(){this.showUpdateDialogVisible()},openPreDialog:function(){this.preDialogVisible=!0},exportConfigFile:function(){window.open("".concat(this.$baseUrl,"fileModelConfig/outputConf?rowCode=").concat(this.rowCode,"&versionId=").concat(this.selectedTplVersion,"&category=").concat(this.category))},uploading:function(){this.isUploading=!0},importSuccess:function(e,t,i){var o=this;e?this.$alert("".concat(e),{confirmButtonText:"确定",callback:function(){o.isUploading=!1}}):this.$message({type:"success",message:"导入成功!"}),this.isUploading=!1},importError:function(){this.$message({type:"error",message:"导入失败，请重新导入!"}),this.isUploading=!1}}),mounted:function(){var e=this;this.$nextTick(function(){e.selectedTplVersion=e.editTplList.selected})}},Le=Ve,Me=(i("0bb8"),Object(p["a"])(Le,U,N,!1,null,"92641bcc",null));Me.options.__file="MainEdit.vue";var Se=Me.exports,$e={name:"App",data:function(){return{}},computed:Object(r["c"])("fileModelConfig",{activeTabName:function(e){return e.activeTab},editContentVisible:function(e){return e.editContentVisible}}),components:{TheLayout:D,MainTab:z,MainEdit:Se},methods:Object(a["a"])({},Object(r["b"])("fileModelConfig",["HideMainEdit","heightResize"]),{hideEditContent:function(){this.HideMainEdit()}}),mounted:function(){this.heightResize(document.body.clientHeight);var e=this;window.onresize=function(){e.heightResize(document.body.clientHeight)}}},je=$e,Pe=(i("d233"),Object(p["a"])(je,o,n,!1,null,"6fb69db6",null));Pe.options.__file="App.vue";var ze=Pe.exports;new R["default"]({store:A,render:function(e){return e(ze)}}).$mount("#app")}});
//# sourceMappingURL=fileModelConfig.09b16174.js.map